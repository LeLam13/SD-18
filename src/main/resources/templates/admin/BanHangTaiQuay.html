<!DOCTYPE html>
<html lang="en" xmlns:th="http:/www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{/admin/index}">

<head>
    <title>ALLDY SNAEKER | B√°n H√†ng T·∫°i Qu·∫ßy</title>
</head>

<body>
    <div class="main-content" layout:fragment="content">
        <style>
            .table th, .table td {
                vertical-align: middle;
            }
            .quantity-input {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .quantity-input input {
                width: 70px;
                text-align: center;
            }
            .remove-btn {
                color: red;
                cursor: pointer;
            }

            .table th,
            .table td {
                padding: 12px;
                /* ƒêi·ªÅu ch·ªânh kho·∫£ng c√°ch gi·ªØa c√°c √¥ */
                /*vertical-align: middle;*/
                /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
            }

            .table th {
                background-color: #f8f9fa;
                /* M√†u n·ªÅn cho ti√™u ƒë·ªÅ c·ªôt */
                position: sticky;
                /* Gi·ªØ ti√™u ƒë·ªÅ c·ªë ƒë·ªãnh khi cu·ªôn */
                top: 0;
                /* V·ªã tr√≠ c·ªßa ti√™u ƒë·ªÅ */
                z-index: 1;
                /* ƒê·∫£m b·∫£o ti√™u ƒë·ªÅ n·∫±m tr√™n c√πng */
            }

            .payment-box {
                border: 1px solid #ccc;
                padding: 10px;
                border-radius: 10px;
                max-width: 350px;
                max-height: 4500px;
                margin: 0 auto;
                font-size: 16px;
            }
            .payment-box input, .payment-box select {
                margin-bottom: 10px;
            }
            .total-amount {
                font-weight: bold;
                font-size: 20px;
            }
            .customer-box {
                border: 1px solid #ccc;  /* Vi·ªÅn x√°m nh·∫°t */
                padding: 10px;           /* Kho·∫£ng c√°ch b√™n trong */
                border-radius: 5px;      /* Bo g√≥c cho h·ªôp */
                background-color: #f9f9f9; /* M√†u n·ªÅn x√°m nh·∫°t */
                color: #a5a5a5;          /* M√†u ch·ªØ x√°m nh·∫°t */
                font-size: 14px;         /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
            }
            .item {
                display: flex;
                flex-direction: column;
                justify-content: center; /* Gi·ªØ c√°c ph·∫ßn t·ª≠ ·ªü gi·ªØa theo chi·ªÅu d·ªçc */
                background-color: #282c34;
                color: white;
                border-radius: 10px;
                padding: 7px;
                width: 80px;
                height: 40px;
                cursor: pointer;
                margin-right: 5px;
                position: relative; /* ƒê·∫∑t c√°c ph·∫ßn t·ª≠ con m·ªôt c√°ch ch√≠nh x√°c */
            }

            /*.item.active {*/
            /*    background-color: #007bff;*/
            /*}*/

            .item .count, .item .badge {
                font-size: 10px;
                font-weight: bold;
                position: absolute;  /* ƒê·∫∑t v·ªã tr√≠ ch√≠nh x√°c */
                left: 5px;           /* Canh sang tr√°i */
            }

            .item .count {
                top: 5px;             /* Canh ph√≠a tr√™n cho count */
            }

            .item .badge {
                bottom: 5px;          /* Canh ph√≠a d∆∞·ªõi cho badge */
            }

            .item .icon {
                font-size: 20px;
                margin: auto;         /* ƒê·∫∑t icon v√†o gi·ªØa */
                z-index: 1;           /* ƒê·∫£m b·∫£o icon n·∫±m tr√™n c√°c ph·∫ßn t·ª≠ kh√°c n·∫øu c·∫ßn */
            }

            .item .close-icon {
                font-size: 12px;
                position: absolute;
                right: 5px;  /* ƒê·∫∑t icon X ·ªü ph√≠a b√™n ph·∫£i */
                top: 5px;    /* Canh ph√≠a tr√™n */
                z-index: 2;  /* ƒê·∫£m b·∫£o icon X n·∫±m tr√™n c√°c ph·∫ßn t·ª≠ kh√°c */
            }

            .plus-button {
                background-color: #282c34;
                color: white;
                border: none;
                border-radius: 50%;
                padding: 10px;
                font-size: 14px;
                cursor: pointer;
            }
            .selected {
                background-color: blue; /* M√†u n·ªÅn khi ƒë∆∞·ª£c ch·ªçn */
            }
        </style>
        <div class="page-content">
            <div class="container-fluid" ng-app="banhang-app" ng-controller="banhang-ctrl">

                <div class="row">
                    <div class="item" ng-repeat="donHangs in donHang" ng-click="selectOrder(donHangs.idDonHang)" ng-class="{'selected': selectedId === donHangs.idDonHang}">
                        <div class="count" hidden>{{ donHangs.idDonHang }}</div>
                        <div class="count">ƒê∆°n</div>
                        <div class="icon">üõí</div>
                        <button ng-click="deleteDonHang(donHangs.idDonHang)" class="close-icon fas fa-times-circle"></button>
                        <div class="badge">{{ $index + 1 }}</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-7">
                        <div class="row">
                            <h2>Gi·ªè h√†ng</h2>
                            <table class="table table-bordered">
                                <thead>
                                <tr>
                                    <th scope="col"></th>
                                    <th scope="col">T√™n S·∫£n ph·∫©m</th>
                                    <th scope="col" class="text-center">S·ªë l∆∞·ª£ng</th>
                                    <th scope="col">ƒê∆°n Gi√°</th>
                                    <th scope="col">Gi√° b√°n</th>
                                    <th scope="col">T·ªïng ti·ªÅn</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="details in productDetails">
                                    <td class="text-center">
                                        <button ng-click="deleteDonHangChiTiet(details.idDonHangChiTiet)" type="button" class="btn btn-danger bi bi-trash3-fill"></button>
                                    </td>
                                    <td>{{ details.tenSanPham}}</td>
                                    <td class="text-center">
                                        <div class="quantity-input">
                                            <button ng-click="soLuongReduce(details)" class="btn btn-outline-secondary">-</button>
                                            <input ng-model="details.soLuong" ng-forcus="saveOriginalQuantity(details)"
                                                   ng-blur="checkQuantity(details)" type="number" class="form-control" value="1" min="1">
                                            <button ng-click="soLuongPlus(details)" class="btn btn-outline-secondary">+</button>
                                        </div>
                                    </td>
                                    <td>{{ details.donGia}}</td>
                                    <td>{{ details.donGia}}</td>
                                    <td>{{details.soLuong*details.donGia}}</td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="row">
                                <nav aria-label="Page navigation example">
                                    <ul class="pagination">
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>

                        <div class="row">
                            <h2>San Pham</h2>
                            <table class="table table-bordered">
                                <thead>
                                <tr>
                                    <th scope="col"></th>
                                    <th scope="col">T√™n S·∫£n ph·∫©m</th>
                                    <th scope="col" class="text-center">S·ªë l∆∞·ª£ng</th>
                                    <th scope="col">ƒê∆°n Gi√°</th>
                                    <th scope="col">Gi√° b√°n</th>
                                    <th scope="col"></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="itemProducts in products">
                                    <td>
                                        <img ng-src="/assets/img/{{itemProducts.hinhAnh}}" alt="" class="img-fluid mx-auto d-block" style="max-height: 100px; max-width: 100px;">
                                    </td>
                                    <td>{{itemProducts.idSanPham.ten}}</td>
                                    <td class="text-center">
                                        {{itemProducts.soLuong}}
                                    </td>
                                    <td>{{itemProducts.donGia}}</td>
                                    <td>{{itemProducts.donGia}}</td>
                                    <td class="text-center">
<!--                                        <span class="remove-btn">&times;</span> &lt;!&ndash; N√∫t remove &ndash;&gt;-->
                                        <button ng-click="addProductsDetail(itemProducts.idSanPhamChiTiet)" class="btn btn-outline-secondary">+</button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="row">
                                <nav aria-label="Page navigation example">
                                    <ul class="pagination">
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <div class="col-5">
                        <div class="row">
                            <div class="col-4">
                                <button ng-click="addDonHang()" type="button" class="btn btn-primary">T·∫°o ƒê∆°n H√†ng</button>
                            </div>
                            <div class="col-5">
                                <button ng-click="openModal()" type="button" class="btn btn-secondary">Ch·ªçn Kh√°ch H√†ng</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="payment-box mt-2">
                                <div class="customer-box">
                                    <div class="input-group">
                                        <span class="input-group-text">Khach Hang</span>
                                        <input type="text" id="nameKH" aria-label="First name" class="form-control">
                                        <input type="text" id="sdtKH" aria-label="Last name" class="form-control">
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">T·ªïng ti·ªÅn:</label>
<!--                                    <span class="total-amount">2,522,500</span>-->
                                    <span class="total-amount">{{getSum()}}</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label" >Phi·∫øu gi·∫£m gi√°:</label>
                                    <select class="form-select" id="discountSelect">
                                        <option value="1" selected>Gi·∫£m gi√° m·ª´ng l·ªÖ</option>
                                    </select>
                                    <span>200,000</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Ti·ªÅn gi·∫£m:</label>
<!--                                    <span>{{ getSum() * (parseFloat(discountRate.replace('%', '')) / 100)}}</span>-->
                                    <span>{{ getTienGiam() }}</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Kh√°ch ph·∫£i tr·∫£:</label>
                                    <span>{{ getTienKhachPTra() }}</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Kh√°ch c√≤n thi·∫øu:</label>
                                    <span>{{ getTienKhachPTra() }}</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Kh√°ch thanh to√°n:</label>
<!--                                    <button class="btn btn-success btn-sm"><i class="bi bi-calculator"></i></button>-->
                                    <input type="text" class="form-control" ng-model="khachThanhToan" id="exampleFormControlInput1">

                                </div>
                                <div class="mb-2">
                                    <label class="form-label">S·ªë ti·ªÅn th·ª´a:</label>
                                    <span>{{ tinhTienThua()  }}</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Ph∆∞∆°ng th·ª©c thanh to√°n:</label>
                                    <select class="form-select" id="paymentMethodSelect">
                                        <option value="2" selected>Ti·ªÅn M·∫∑t</option>
                                        <option value="3" >Thanh To√°n Online</option>
                                    </select>
                                    <span>200,000</span>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label">Ghi ch√∫:</label>
                                    <textarea class="form-control" rows="2"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-4">
                                <button ng-click="createHoaDon()" type="button" class="btn btn-primary">L∆∞u Ho√° ƒê∆°n</button>
                            </div>
                            <div class="col-4">
                                <button  type="button" class="btn btn-secondary">In Ho√° ƒê∆°n</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!--modal-->
                <div class="modal fade" id="show-modal-khach" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">STT</th>
                                        <th scope="col">T√™n Kh√°ch H√†ng</th>
                                        <th scope="col">S·ªë ƒêi·ªán Tho·∫°i</th>
                                        <th scope="col"></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="kh in khachHang">
                                        <th scope="row">{{ $index + 1 }}</th>
                                        <td>{{ kh.maKhachHang }}</td>
                                        <td>{{ kh.hoTen }}</td>
                                        <td>{{ kh.soDienThoai }}</td>
                                        <td>
                                            <button ng-click="getKhachHangByID(kh.idKhachHang)" type="button" class="btn btn-primary bi bi-box-fill"></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>



</body>

</html>